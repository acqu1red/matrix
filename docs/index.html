<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<title>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ ‚Äî –ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<link rel="stylesheet" href="styles.css?v=2.0">
</head>
<body>
<header>
  <h1>
    –ß–∞—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 24 24"
      fill="none"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
      aria-label="–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
      role="img"
    >
      <polygon points="12 1.5 16.5 8.5 23 9.5 18.5 15 19.5 22.5 12 18.5 4.5 22.5 5.5 15 1 9.5 7.5 8.5" />
    </svg>
  </h1>
</header>

<main id="mainContent">
  <!-- –û–±—ã—á–Ω—ã–π —á–∞—Ç -->
  <div class="chat" id="chat"></div>
  
  <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
  <div class="admin-panel" id="adminPanel">
    <div class="admin-header">
      <div class="admin-title">–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</div>
      <button class="back-btn" id="backToChat">‚Üê –ù–∞–∑–∞–¥</button>
    </div>
    <div class="admin-stats" id="adminStats">
      <div class="stats-grid">
        <div class="stat-item clickable" id="filterAll" data-filter="all">
          <div class="stat-number" id="totalConversations">0</div>
          <div class="stat-label">–í—Å–µ–≥–æ –¥–∏–∞–ª–æ–≥–æ–≤</div>
        </div>
        <div class="stat-item clickable active" id="filterPending" data-filter="pending">
          <div class="stat-number" id="openConversations">0</div>
          <div class="stat-label">–û–∂–∏–¥–∞—é—Ç –æ—Ç–≤–µ—Ç–∞</div>
        </div>
        <div class="stat-item clickable" id="filterMessages" data-filter="messages">
          <div class="stat-number" id="totalMessages">0</div>
          <div class="stat-label">–í—Å–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π</div>
        </div>
      </div>
    </div>
    <div class="conversations-list" id="conversationsList">
      <div class="loading">
        <div class="spinner"></div>
      </div>
    </div>
  </div>

  <!-- –î–∏–∞–ª–æ–≥ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º -->
  <div class="conversation-dialog" id="conversationDialog">
    <div class="dialog-header">
      <div class="dialog-user-info">
        <div class="dialog-username" id="dialogUsername">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
        <div class="dialog-meta" id="dialogMeta">–°–æ–æ–±—â–µ–Ω–∏–π: 0</div>
      </div>
      <button class="back-btn" id="backToAdmin">‚Üê –ö —Å–ø–∏—Å–∫—É</button>
    </div>
    <div class="chat" id="dialogChat"></div>
    <footer class="message-footer">
      <div class="input-container">
        <input type="file" id="dialogFileInput" />
        <input type="text" id="dialogMessageInput" placeholder="–û—Ç–≤–µ—Ç–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é..." autocomplete="off" />
        <div class="button-group">
          <button id="dialogAttachBtn" class="action-btn attach-btn" title="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª" aria-label="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/>
            </svg>
          </button>
          <button id="dialogSendBtn" class="action-btn send-btn" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ" aria-label="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
            </svg>
          </button>
        </div>
      </div>
    </footer>
  </div>
</main>

<!-- –û–±—ã—á–Ω—ã–π footer –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
<footer id="userFooter" class="message-footer">
  <div class="input-container">
    <input type="file" id="fileInput" />
    <input type="text" id="messageInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." autocomplete="off" />
    <div class="button-group">
      <button id="attachBtn" class="action-btn attach-btn" title="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª" aria-label="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/>
        </svg>
      </button>
      <button id="sendBtn" class="action-btn send-btn" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ" aria-label="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
        </svg>
      </button>
    </div>
  </div>
</footer>

<!-- –ê–¥–º–∏–Ω footer –¥–ª—è –∫–Ω–æ–ø–∫–∏ –ø–∞–Ω–µ–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
<div class="admin-footer" id="adminFooter">
  <button class="admin-panel-btn hidden" id="adminPanelBtn">
    üë§ –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
  </button>
</div>

<script type="module" src="script.js?v=2.0"></script>
</body>
</html>